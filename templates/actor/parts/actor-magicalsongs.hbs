<ol class='items-list'>
  {{#if noteshow}}
    <div class='item flexrow items-header'>
      <div class='item-name'>{{localize "TYPES.Item.magicalsong"}}</div>
    </div>
    <div class='item flexrow ability-resource'>
      <div class='resources'>
        <div class="abirity-label">{{localize "SW25.Item.Magicalsong.Music"}}</div>
        {{#each notes as |item id|}}
          <li class='item' data-item-id='{{item._id}}'>
            <div>
              <div class="item-prop flexrow flex-group-center">
                <h4 class="item-label">{{item.name}}</h4>
              </div>
              {{#if ../isOwner}}
                <div class='item-quantity item-prop flexrow flex-group-center' style="flex: 0 0 80px;">
                  <a class="quantity-button" data-action="decrease" data-property="item.system.quantity">
                    <i class="fas fa-minus"></i>
                  </a>
                  <input class="qt-change" type="text" name="quantityInput" value="{{item.system.quantity}}" data-dtype="Number"/>
                  <a class="quantity-button" data-action="increase" data-property="item.system.quantity">
                    <i class="fas fa-plus"></i>
                  </a>
                </div>
                <div class='item-controls'>
                  <a class='item-control item-edit' title='{{localize "DOCUMENT.Update" type=(localize "TYPES.Item.resource")}}'>
                    <i class='fas fa-edit'></i>
                  </a>
                  <a class='item-control item-delete' title='{{localize "DOCUMENT.Delete" type=(localize "TYPES.Item.resource")}}'>
                    <i class='fas fa-trash'></i>
                  </a>
                </div>
              {{else}}
                <div class='item-quantity item-prop flexrow flex-group-center' style="flex: 0 0 80px;">
                  <input class="qt-change" type="text" name="quantityInput" value="{{item.system.quantity}}" data-dtype="Number"/>
                </div>
              {{/if}}
            </div>
          </li>
        {{/each}}
      </div>
      <div class='item-element' style="flex: 0 0 240px;">&nbsp;</div>
    </div>
  {{/if}}
  <li class='item flexrow items-header'>
    <div class='item-name'>{{#if noteshow}}{{localize "SW25.Item.Name"}}{{else}}{{localize "TYPES.Item.magicalsong"}}{{/if}}</div>
    <div class='item-element' style="flex: 0 0 50px;">{{localize "SW25.Item.Magicalsong.Music"}}</div>
    <div class='item-element' style="flex: 0 0 70px;">{{localize "SW25.Adding"}}</div>
    <div class='item-element' style="flex: 0 0 40px;">{{localize "SW25.Item.Resist"}}</div>
    <div class='item-element' style="flex: 0 0 80px;">{{localize "SW25.Item.Prop"}}</div>
    <div class='item-controls'>
      <a
        class='item-control item-create'
        title='{{localize "DOCUMENT.Create" type=(localize "TYPES.Item.magicalsong")}}'
        data-type='magicalsong'
      >
        <i class='fas fa-plus'></i>
        {{localize 'DOCUMENT.New' type=''}}
      </a>
    </div>
  </li>
  {{#each magicalsongs as |item id|}}
    <li class='item' data-item-id='{{item._id}}'>
      <div class="flexrow flex-group-center">
        <div class='item-name'>
          <div class="item-equip">
            {{#if system.useequip}}
            <label class="equip-toggle">
              <input class="eq-change" type="checkbox" name="system.equip" data-dtype="Boolean" {{#if system.equip}} checked {{/if}}/>
            </label>
            {{/if}}
          </div>
          <div class='item-image'>
            <a class='rollable' data-roll-type='item'>
              <img
                src='{{item.img}}'
                title='{{item.name}}'
                width='24'
                height='24'
              />
            </a>
          </div>
          {{> "systems/sw25/templates/helper/action-marks.hbs"}}
          <{{system.typename}}><h4 class="item-label">{{item.name}}</h4>
        </div>
        <div class="rollable" style="flex: 0 0 40px; display: {{#if system.usedice}}block{{else}}none{{/if}};" data-roll="{{item.system.checkformula}}+{{item.system.checkbase}}" data-label="{{item.name}} ({{localize "SW25.Check"}})" data-pt="{{item.system.powertable}}" data-apply="{{system.applycheck}}" data-checktype="{{system.checkTypesButton}}">
          <b>{{localize "SW25.Item.CheckB"}}</b>
        </div>
        <div class="powerrollable" style="flex: 0 0 40px; display: {{#if system.usepower}}block{{else}}none{{/if}};" data-roll="{{item.system.powerformula}}" data-label="{{item.name}} ({{localize "SW25.Item.Power"}})" data-pt="{{item.system.powertable}}" data-apply="{{system.applypower}}" data-powertype="{{system.powerTypesButton}}">
          <b>{{localize "SW25.Item.PowerB"}}</b>
        </div>
        <div class="applyeffect" style="flex: 0 0 40px; display: {{#if system.useeffect}}block{{else}}none{{/if}};">
          <b>{{localize "SW25.Item.EffectB"}}</b>
        </div>
        <div class='item-quantity item-prop flexrow flex-group-center' style="flex: 0 0 50px;">
          {{#if (eq system.type "song")}}{{#unless (eq system.upget 0)}}↑{{system.upget}}{{/unless}}{{#unless (eq system.downget 0)}}↓{{system.downget}}{{/unless}}{{#unless (eq system.charmget 0)}}♡{{system.charmget}}{{/unless}}{{/if}}
          {{#if (eq system.type "final")}}{{#unless (eq system.upcost 0)}}↑{{system.upcost}}{{/unless}}{{#unless (eq system.downcost 0)}}↓{{system.downcost}}{{/unless}}{{#unless (eq system.charmcost 0)}}♡{{system.charmcost}}{{/unless}}{{/if}}
        </div>
        <div class='item-quantity item-prop flexrow flex-group-center' style="flex: 0 0 70px;">
          {{#if (eq system.type "song")}}{{#unless (eq system.upadd 0)}}↑{{system.upadd}}{{/unless}}{{#unless (eq system.downadd 0)}}↓{{system.downadd}}{{/unless}}{{#unless (eq system.charmadd 0)}}♡{{system.charmadd}}{{/unless}}({{system.singpoint}}){{/if}}
        </div>
        <div class='item-quantity item-prop flexrow flex-group-center' style="flex: 0 0 40px;">
          {{system.resistname}}
        </div>
        <div class='item-quantity item-prop flexrow flex-group-center' style="flex: 0 0 80px;">
          {{system.propname}}
        </div>
        {{#if ../isOwner}}
          <div class='item-controls'>
            <a
              class='item-control item-edit'
              title='{{localize "DOCUMENT.Update" type=(localize "TYPES.Item.magicalsong")}}'
            >
              <i class='fas fa-edit'></i>
            </a>
            <a
              class='item-control item-delete'
              title='{{localize "DOCUMENT.Delete" type=(localize "TYPES.Item.magicalsong")}}'
            >
              <i class='fas fa-trash'></i>
            </a>
          </div>
        {{else}}
          <div class='item-controls'>
            <a
              class='item-control item-edit'
              title='{{localize "DOCUMENT.Update" type=(localize "TYPES.Item.magicalsong")}}'
            >
              <i class='fa-solid fa-eye'></i>
            </a>
          </div>
        {{/if}}
      </div>
      <div class="item-description nogapmargin">
        <div class="flexrow">
          <div style="flex: 0 0 60px;"></div>
          <div style="font-size: 0.8em;">
            {{{system.description}}}
          </div>
          <div style="flex: 0 0 50px;"></div>
        </div>
      </div>
    </li>
  {{/each}}
</ol>
